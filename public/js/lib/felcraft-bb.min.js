!function(a,b,c){FC.Characters=Backbone.Collection.extend({model:FC.Character})}(window,jQuery,_),function(a,b,c){FC.Character=Backbone.Model.extend({defaults:{region:"eu",server:"frostwhisper",name:"coryn",isVerified:!1,items:[],talents:[],glyphs:[],last_optimised:null},verify:function(){var a=this;console.log("Verifying ",a.name," character..."),b.ajax({url:"/character/verify",success:function(b,c){console.log("Character confirmed. OK!"),a.set({isVerified:!0})},error:function(a){console.log("Failed to verify character: ",a)}})}})}(window,jQuery,_),function(a,b,c){FC.CharacterView=Backbone.View.extend({el:"#content",template:c.template(b("#charTemplate").html()),initialize:function(a){this.model=a,console.log("Initializing Character View with ",this.model),this.model.get("isVerified")?this.render():(this.model.on("change:isVerified",this.verifyChanged,this),this.model.verify())},verifyChanged:function(){this.render()},render:function(){return this.model.get("isVerified")&&b(document).attr("title",this.model.get("name")+"@"+this.model.get("server")+" | FelCraft"),this.$el.html(this.template(this.model.attributes)),this}})}(window,jQuery,_),function(a,b,c){FC.CharactersView=Backbone.View.extend({el:"#content",initialize:function(a){this.collection=new FC.Characters(a),this.render()},render:function(){this.collection.each(function(a){this.renderChar(a)},this)},renderChar:function(a){var b=new FC.CharacterView({model:a});this.$el.append(b.render().el)}})}(window,jQuery,_),function(a,b,c){FC.NewCharSplashView=Backbone.View.extend({el:"#content",template:c.template(b("#newCharSplash").html()),events:{"click #felcraft-start-btn":"verifyChar"},initialize:function(a){this.model=new FC.Character(a),this.model.on("change:isVerified",this.verifyChanged,this),this.render(),b(document).attr("title","New | FelCraft")},verifyChar:function(a){var b=this.model,c=this;console.log("Init char fired");var d=this.$("#felcraft-charname-txt").val(),e=this.$("#felcraft-server-txt").val(),f=this.$("input:radio[name ='radioInline']:checked").val();""!==d&&""!==e&&(b.set({name:d,server:e,region:f}),this.$("#felcraft-char-form").fadeOut("fast",function(){c.$("#loading-spinner").fadeIn()}),setTimeout(function(){b.verify()},2750))},verifyChanged:function(){var a=this;this.model.get("isVerified")?(this.$("#loading-status-msg").html("Got it!<br />"),setTimeout(function(){this.$("#loading-status-msg").html("Grabbing metrics..."),setTimeout(function(){this.$("#loading-status-msg").html("All done! Rendering application..."),setTimeout(function(){FCI.active_router.navigate("app/"+a.model.get("region")+"/"+a.model.get("server")+"/"+a.model.get("name"),{trigger:!0}),a.close()},1e3)},2e3)},1500)):console.log("Error, character wasnt verified")},render:function(){return this.$el.html(this.template()),this},close:function(){this.unbind()}})}(window,jQuery,_);